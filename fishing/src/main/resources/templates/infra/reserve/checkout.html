<!DOCTYPE html>
<html lang="en">

<head>
    <div th:replace="~{infra/include/head :: head}"></div>
</head>

<body>
	<form name="formName" id="formName" method="post" autocomplete="off">
		<input type="hidden" id="plcSeq" name="plcSeq" th:value="${plcSeq}">
		<input type="hidden" id="plcName" name="plcName" th:value="${plcName}">
        <input type="hidden" id="revDate" name="revDate" th:value="${reservationDate}">
        <input type="hidden" id="revPlaceCd" name="revPlaceCd" th:value="${plcTypeCd}">
        <input type="hidden" id="revSeat" name="revSeat" th:value="${revSeat}">
        <input type="hidden" id="revAmount" name="revAmount" th:value="${plcAmount}">
	    <div class="page-wrapper">
		    <header class="header">
	            <div class="header-middle sticky-header font2">
	                <div class="container-fluid">
	                    <div class="header-left">
	                        <button class="mobile-menu-toggler pl-0" type="button">
	                            <i class="fas fa-bars"></i>
	                        </button>
	                        <a href="/index" class="logo mr-5">
	                            <img src="img/logo.png" alt="Logo" width="111" height="44">
	                        </a>
	                        <!--메인메뉴-->
	                        <div th:replace="~{infra/include/body :: menu(1)}"></div>
	                        
							<div class="align-items-center ml-5">
								<nav aria-label="breadcrumb" class="breadcrumb-nav">
									<div class="container">
										<ol class="breadcrumb">
											<li class="breadcrumb-item" style="color: blue;">
												<a href="/index"><i class="fas fa-fish">&nbsp;</i><b>Home</b></a>
											</li>
											<li class="breadcrumb-item active" aria-current="page">Reservation</li>
										</ol>
									</div>
								</nav>
							</div>
	                    </div>
						<!--우측메뉴-->
	                    <div th:replace="~{infra/include/body :: menuRight}"></div>
	                </div>
	            </div>
	        </header>
	        <!-- End .header -->
	
	        <main class="main main-test">
	            <div class="container checkout-container">
	                <div class="row">
	                    <div class="col-lg-12">
	                        <div class="order-summary">
	                            <h3>결제정보</h3>
	                            <table class="table table-mini-cart">
	                                <thead>
	                                    <tr>
	                                        <th>업체명</th>
	                                        <th>예약날짜</th>
	                                        <th>낚시터종류</th>
	                                        <th>좌석번호</th>
	                                        <th>결제금액</th>
	                                    </tr>
	                                </thead>
	                                <tbody>
	                                    <tr>
	                                        <th th:text="${plcName}"></th>
	                                        <th th:text="${reservationDate}"></th>
	                                        <th th:text="${@codeService.selectOneCachedCode(plcTypeCd)} + '낚시'"></th>
	                                        <th th:text="${revSeat} +'번'"></th>
	                                        <th th:text="${#numbers.formatInteger(plcAmount,1,'COMMA')} + '원'"></th>
	                                    </tr>
	                                </tbody>
	                            </table>
	                        </div>
	                        <div class="order-summary">
	                            <div class="shipping-info">
	                                <h3 class="">일반결제</h3>
	                                <div class="row">
	                                    <div class="col-6">
	                                        <div class="select-custom">
	                                            <h4>카드사명<abbr class="required" title="required">*</abbr></label></h4>
	                                            <select class="form-control" id="payCardCd" name="payCardCd">
	                                                <option value="44">신한</option>
	                                                <option value="45">삼성</option>
	                                                <option value="46">농협</option>
	                                            </select>
	                                        </div>
	                                    </div>
	                                    <div class="col-6">
	                                        <div class="form-group">
	                                            <h4>성함<abbr class="required" title="required">*</abbr></label></h4>
	                                            <input type="text" class="form-control" id="payName" name="payName" value="홍길동">
	                                            <span id="payNameValid" name="payNameValid" style="visibility: hidden;"></span>
	                                        </div>
	                                    </div>
	                                    <div class="col-12">
	                                        <div class="form-group">
	                                            <h4>카드번호<abbr class="required" title="required">*</abbr></label></h4>
	                                            <input type="text" class="form-control" id="payNunber" name="payNunber" value="1234-5678-1234-5678">
	                                            <span id="payNunberValid" name="payNunberValid" style="visibility: hidden;"></span>
	                                        </div>
	                                    </div>
	                                    <div class="col-4">
	                                        <div class="form-group">
	                                            <h4>MM<abbr class="required" title="required">*</abbr></label></h4>
	                                            <input type="text" class="form-control" id="payMM" name="payMM" value="12">
	                                            <span id="payMMValid" name="payMMValid" style="visibility: hidden;"></span>
	                                        </div>
	                                    </div>
	                                    <div class="col-4">
	                                        <div class="form-group">
	                                            <h4>YY<abbr class="required" title="required">*</abbr></label></h4>
	                                            <input type="text" class="form-control" id="payYY" name="payYY" value="25">
	                                            <span id="payYYValid" name="payYYValid" style="visibility: hidden;"></span>
	                                        </div>
	                                    </div>
	                                    <div class="col-4">
	                                        <div class="form-group">
	                                            <h4>cvc<abbr class="required" title="required">*</abbr></label></h4>
	                                            <input type="password" class="form-control" id="payCVC" name="payCVC" value="123">
	                                            <span id="payCVCValid" name="payCVCValid" style="visibility: hidden;"></span>
	                                        </div>
	                                    </div>
	                                </div>
	                            </div>
	                            <button type="button" class="btn btn-dark btn-place-order" id="additional" name="additional">결제하기</button>
	                        </div>
	                    </div>
	                </div>
	            </div>
	        </main>
	    </div>
	</form>
    <footer th:replace="~{infra/include/body :: footer}"></footer>
    <a id="scroll-top" href="#top" title="Top" role="button"><i class="icon-angle-up"></i></a>
    <!-- Plugins JS File -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/plugins.min.js"></script>
    <script src="assets/js/validation.js"></script>

    <!-- Main JS File -->
    <script src="assets/js/main.min.js"></script>
    <script type="text/javascript">
	 // 입력 필드의 값을 감시하는 함수
		 function formatCardNumber() {
		     var cardInput = document.getElementById('payNunber');
		     var inputValue = cardInput.value;
	
		     // 숫자만 남기고 다른 문자 제거
		     var cleanedValue = inputValue.replace(/[^0-9]/g, '');
	
		     // 하이픈을 포함하여 포맷팅
		     var formattedValue = '';
		     for (var i = 0; i < cleanedValue.length; i++) {
		         if (i > 0 && i % 4 === 0) {
		             formattedValue += '-';
		         }
		         formattedValue += cleanedValue[i];
		     }
	
		     // 포맷팅된 값을 입력 필드에 다시 설정
		     cardInput.value = formattedValue;
		 }
	
		 // 입력 필드의 값이 변경될 때마다 formatCardNumber 함수 호출
		 document.getElementById('payNunber').addEventListener('input', formatCardNumber);
    </script>
    <script type="text/javascript">
 	// 필수입력체크대상
	// validType : 1(한글), 2(영문), 3(숫자:정수), 4(숫자:실수), 5(숫자콤마)
	//             10(한글영문), 11(한글숫자), 12(영문숫자), 13(한글영문숫자)
	//			   20(비밀번호), 21(날짜), 22(이메일)
	//             30(특수문자), 31(공백체크)
	//			   32(숫자16자리), 33(카드년도), 34(카드월), 35(카드보안)
	// TYPE_KR   =  1, TYPE_EN   = 2,  TYPE_IT   = 3,  TYPE_FT     = 4;  TYPE_ICM = 5;
	// TYPE_KREN = 10, TYPE_KRIT = 11, TYPE_ENIT = 12, TYPE_KRENIT = 13;
	// TYPE_PW   = 20, TYPE_DT   = 21, TYPE_EM   = 22;
	// TYPE_SP   = 30, TYPE_NULL = 31;
	// TYPE_CARD = 32; TYPE_YY	 = 33; TYPE_MM	 = 34; TYPE_CVC    = 35;
	let dispText = "";
	let typeArr = [3,10,32,34,33,35];		
	let nameArr = ["payCardCd","payName","payNunber","payMM","payYY","payCVC"];
	let textArr = ["카드사를 선택을 하세요","이름은 한글, 영문대소문자만 입력 가능합니다.","카드번호는 숫자 16자리만 입력 가능합니다.","카드유호월은 숫자 2자리(01~12)만 입력 가능합니다.","카드유호년도는 숫자 2자리만 입력 가능합니다.","카드보안번호는 숫자 3자리만 입력 가능합니다."];
    
    
    document.getElementById("additional").onclick = function () {
		insertCall();
	}
	 let form = document.querySelector("form[name=formName]");
	 
	 window.addEventListener('load', function() {
			$("#revDate").datetimepicker({
				timepicker : false,
				format : 'Y/m/d'
			});
	 });
	 
	 insertCall = function() {
		if(!fnValidation()) {return false;};
		form.action = "/insert";
		form.submit();
			
		}
	 
    </script>
</body>

</html>